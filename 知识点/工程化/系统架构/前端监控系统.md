# 行内通用方案

前端技术发展至今，相信大家已经对前端监控的这件事情非常熟悉，或多或少都会在我们的项目中用上它。比如搭建使用开源项目 sentry、付费平台阿里的 ARMS、甚至小程序配套的前端监控服务。

1. sentry，sentry 主要提供的功能是收集错误。支持大多流行语言的客户端和服务端，不支持小程序，但是目前有大公司根据 sentry 的上报数据结构，自己实现了小程序 SDK 并开源，目前关注度和流行度都偏低。除开错误，它的其它类型的前端监控能力相对来说很弱。
2. 阿里 ARMS，ARMS 提供的功能与支持的客户端比较齐全，小程序也支持。只是需要付费。总体来说提供的功能还是比较全面、符合国内的环境。
3. 小程序自带监控 微信小程序不断的在完善内部的监控，各方面的功能也慢慢丰富了起来，但是只能支持小程序本身。

在使用这些开源或者平台前端监控服务的时候，始终有一些不足。比如：

- 系统分散
- 很难满足增加一些自定义数据和查询的需求
- 特性一直不更新、BUG 解决周期长
- 二次开发难度大

# 系统架构

### 基本构成

![image-20220312213842875](https://chenjing-oss.oss-cn-hangzhou.aliyuncs.com/typora/image-20220312213842875.png)

### 技术的可能的一些难点

##### 前端存储日志

![image-20220312214125049](https://chenjing-oss.oss-cn-hangzhou.aliyuncs.com/typora/image-20220312214125049.png)

IndexDB 是最好的选择，它具有容量大、异步的优势，异步的特性保证它不会对界面的渲染产生阻塞。可以是用hello-indexDB这个工具简化操作；

##### 日志上报

![image-20220312214219345](https://chenjing-oss.oss-cn-hangzhou.aliyuncs.com/typora/image-20220312214219345.png)